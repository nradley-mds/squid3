{% set map = salt['grains.filter_by']({
    'Ubuntu': {
        'pkgs': ['squid3'],
        'service': 'squid3',
        'conf_dir': '/etc/squid3',
        'conf_file': 'squid.conf',
        'whitelist_dir': '/etc/squid3',
        'whitelist_file': 'whitelist',
        'cache': '/var/spool/squid',
    },
}, grain='os', merge=salt['pillar.get']('squid:lookup')) %}
